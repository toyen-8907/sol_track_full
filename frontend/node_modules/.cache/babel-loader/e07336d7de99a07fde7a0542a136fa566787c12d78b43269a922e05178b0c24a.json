{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useContext } from 'react';\nimport { WebSocketContext } from './App';\nconst WebSocketComponent = ({\n  account,\n  onSolBalanceReceived,\n  onSPLBalancesReceived\n}) => {\n  _s();\n  const ws = useContext(WebSocketContext);\n  useEffect(() => {\n    if (ws && ws.readyState === WebSocket.OPEN) {\n      ws.send(JSON.stringify({\n        action: 'subscribe',\n        account\n      }));\n    }\n    const handleMessage = event => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'solBalance' && data.account === account) {\n        onSolBalanceReceived(parseFloat(data.balance));\n      } else if (data.type === 'splBalances' && data.account === account) {\n        onSPLBalancesReceived(data.balances);\n      } else if (data.type === 'heartbeat') {\n        console.log('收到心跳消息');\n      }\n    };\n    ws.addEventListener('message', handleMessage);\n    return () => {\n      if (ws && ws.readyState === WebSocket.OPEN) {\n        ws.send(JSON.stringify({\n          action: 'unsubscribe',\n          account\n        }));\n      }\n      ws.removeEventListener('message', handleMessage);\n    };\n  }, [ws, account, onSolBalanceReceived, onSPLBalancesReceived]);\n  return null;\n};\n_s(WebSocketComponent, \"H35Q5FnXNNnOWvNTT2H3HxNgFIM=\");\n_c = WebSocketComponent;\nexport default WebSocketComponent;\nvar _c;\n$RefreshReg$(_c, \"WebSocketComponent\");","map":{"version":3,"names":["React","useEffect","useContext","WebSocketContext","WebSocketComponent","account","onSolBalanceReceived","onSPLBalancesReceived","_s","ws","readyState","WebSocket","OPEN","send","JSON","stringify","action","handleMessage","event","data","parse","type","parseFloat","balance","balances","console","log","addEventListener","removeEventListener","_c","$RefreshReg$"],"sources":["/Users/damentp01/project/sol_track_full/frontend/src/WebSocketComponent.js"],"sourcesContent":["import React, { useEffect, useContext } from 'react';\nimport { WebSocketContext } from './App';\n\nconst WebSocketComponent = ({ account, onSolBalanceReceived, onSPLBalancesReceived }) => {\n  const ws = useContext(WebSocketContext);\n\n  useEffect(() => {\n    if (ws && ws.readyState === WebSocket.OPEN) {\n      ws.send(JSON.stringify({ action: 'subscribe', account }));\n    }\n\n    const handleMessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'solBalance' && data.account === account) {\n        onSolBalanceReceived(parseFloat(data.balance));\n      } else if (data.type === 'splBalances' && data.account === account) {\n        onSPLBalancesReceived(data.balances);\n      } else if (data.type === 'heartbeat') {\n        console.log('收到心跳消息');\n      }\n    };\n\n    ws.addEventListener('message', handleMessage);\n\n    return () => {\n      if (ws && ws.readyState === WebSocket.OPEN) {\n        ws.send(JSON.stringify({ action: 'unsubscribe', account }));\n      }\n      ws.removeEventListener('message', handleMessage);\n    };\n  }, [ws, account, onSolBalanceReceived, onSPLBalancesReceived]);\n\n  return null;\n};\n\nexport default WebSocketComponent;\n"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACpD,SAASC,gBAAgB,QAAQ,OAAO;AAExC,MAAMC,kBAAkB,GAAGA,CAAC;EAAEC,OAAO;EAAEC,oBAAoB;EAAEC;AAAsB,CAAC,KAAK;EAAAC,EAAA;EACvF,MAAMC,EAAE,GAAGP,UAAU,CAACC,gBAAgB,CAAC;EAEvCF,SAAS,CAAC,MAAM;IACd,IAAIQ,EAAE,IAAIA,EAAE,CAACC,UAAU,KAAKC,SAAS,CAACC,IAAI,EAAE;MAC1CH,EAAE,CAACI,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;QAAEC,MAAM,EAAE,WAAW;QAAEX;MAAQ,CAAC,CAAC,CAAC;IAC3D;IAEA,MAAMY,aAAa,GAAIC,KAAK,IAAK;MAC/B,MAAMC,IAAI,GAAGL,IAAI,CAACM,KAAK,CAACF,KAAK,CAACC,IAAI,CAAC;MACnC,IAAIA,IAAI,CAACE,IAAI,KAAK,YAAY,IAAIF,IAAI,CAACd,OAAO,KAAKA,OAAO,EAAE;QAC1DC,oBAAoB,CAACgB,UAAU,CAACH,IAAI,CAACI,OAAO,CAAC,CAAC;MAChD,CAAC,MAAM,IAAIJ,IAAI,CAACE,IAAI,KAAK,aAAa,IAAIF,IAAI,CAACd,OAAO,KAAKA,OAAO,EAAE;QAClEE,qBAAqB,CAACY,IAAI,CAACK,QAAQ,CAAC;MACtC,CAAC,MAAM,IAAIL,IAAI,CAACE,IAAI,KAAK,WAAW,EAAE;QACpCI,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;MACvB;IACF,CAAC;IAEDjB,EAAE,CAACkB,gBAAgB,CAAC,SAAS,EAAEV,aAAa,CAAC;IAE7C,OAAO,MAAM;MACX,IAAIR,EAAE,IAAIA,EAAE,CAACC,UAAU,KAAKC,SAAS,CAACC,IAAI,EAAE;QAC1CH,EAAE,CAACI,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC;UAAEC,MAAM,EAAE,aAAa;UAAEX;QAAQ,CAAC,CAAC,CAAC;MAC7D;MACAI,EAAE,CAACmB,mBAAmB,CAAC,SAAS,EAAEX,aAAa,CAAC;IAClD,CAAC;EACH,CAAC,EAAE,CAACR,EAAE,EAAEJ,OAAO,EAAEC,oBAAoB,EAAEC,qBAAqB,CAAC,CAAC;EAE9D,OAAO,IAAI;AACb,CAAC;AAACC,EAAA,CA9BIJ,kBAAkB;AAAAyB,EAAA,GAAlBzB,kBAAkB;AAgCxB,eAAeA,kBAAkB;AAAC,IAAAyB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}